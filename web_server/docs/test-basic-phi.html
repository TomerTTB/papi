<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHI Basic Suite - API Testing Platform</title>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="../styles/common.css" rel="stylesheet">
    <link href="styles/docs.css" rel="stylesheet">
</head>
<body>
    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mt-3 mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/" class="text-decoration-none">Home</a></li>
                    <li class="breadcrumb-item"><a href="/docs" class="text-decoration-none">Documentation</a></li>
                    <li class="breadcrumb-item active">PHI Basic Suite</li>
                </ol>
            </nav>

            <div class="row">
                <!-- Sidebar Navigation -->
                <div id="sidebar-placeholder"></div>

                <!-- Documentation Content -->
                <div class="col-md-9">
                    <div class="wiki-content">
                        <h1>PHI Basic Suite Documentation</h1>
                        <div class="alert alert-info">
                            <h4 class="h5">Summary</h4>
                            <p>
                                The PHI Basic Suite verifies authentication enforcement for PHI endpoints, focusing on method validation and missing authentication token errors. It ensures that endpoints requiring PHI SID handle invalid HTTP methods and authentication scenarios correctly.
                            </p>
                        </div>

                        <h2 id="phi-basic-tests">PHI Basic Test Cases Overview</h2>
                        <ol>
                            <li><strong>Invalid Method and Missing Authentication Token</strong>
                                <ul>
                                    <li>Verifies that using an invalid HTTP method (e.g., GET instead of POST) returns a 403 status and a "Missing Authentication Token" message.</li>
                                </ul>
                                <pre class="bg-dark text-light p-3">test('Invalid Method', async ({ request }) => {
    // ...
    const response = await executeRequest(test, request, invalidEndpoint, endpoint.config.requiredHeaders);
    expect(response.status()).toBe(403);
    expect(await response.json()).toEqual({ message: "Missing Authentication Token" });
});</pre>
                            </li>
                            <li><strong>PHI SID Handling</strong>
                                <ul>
                                    <li>For endpoints like <code>go_eyes</code> and <code>user_details_stage</code>, a new PHI SID is obtained and injected into the request body before each test.</li>
                                </ul>
                                <pre class="bg-dark text-light p-3">// Example usage in each test
if (endpoint.path === 'go_eyes' || endpoint.path === 'user_details_stage') {
    const newPhiSid = await getNewPhiSid(test, request);
    endpoint.config.requestBody.phi_sid = newPhiSid;
}</pre>
                            </li>
                        </ol>

                        <h3>PHI SID Update Mechanism</h3>
                        <p>
                            The PHI SID update process is handled by a helper module (e.g., <code>phiSidUpdater.js</code>):
                        </p>
                        <ul>
                            <li>Detects PHI endpoints (such as <code>go_eyes</code> and <code>user_details_stage</code>).</li>
                            <li>Obtains a new PHI SID from the questionnaire stage endpoint.</li>
                            <li>Updates the request body with the new PHI SID before each test.</li>
                        </ul>
                        <pre class="bg-dark text-light p-3">async function getNewPhiSid(test, request) {
    // 1. Temporarily switch to PHI base URL
    // 2. Call questionnaire_stage endpoint
    // 3. Extract new PHI SID from response
    // 4. Return the new PHI SID for use in tests
}</pre>

                        <h3>Configuration</h3>
                        <p>
                            The PHI Basic Suite uses specific configuration elements:
                        </p>
                        <ul>
                            <li><strong>Environment Variables:</strong>
                                <ul>
                                    <li>PHI_BASE_URL: Base URL for PHI endpoints (defaults to https://phi-staging.6over6.com)</li>
                                </ul>
                            </li>
                            <li><strong>Endpoint Configuration:</strong>
                                <ul>
                                    <li>product: 'PHI' identifier</li>
                                    <li>Required headers specific to PHI endpoints</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Template Loader -->
    <script src="../scripts/template-loader.js"></script>
    <!-- Version Fetcher -->
    <script src="../scripts/version-fetcher.js"></script>
    <!-- Sidebar Loader -->
    <script src="scripts/sidebar-loader.js"></script>
    <!-- Documentation Scripts -->
    <script src="scripts/docs.js"></script>
</body>
</html> 